<!DOCTYPE html><html lang="zh-CN"><head><meta name="generator" content="Hexo 3.8.0"><meta http-equiv="content-type" content="text/html; charset=utf-8"><meta content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0" name="viewport"><meta content="yes" name="apple-mobile-web-app-capable"><meta content="black-translucent" name="apple-mobile-web-app-status-bar-style"><meta content="telephone=no" name="format-detection"><meta name="description"><title>题红 | 解决 Abode typekit 加载字体过慢 | 懒云休憩室</title><link rel="stylesheet" type="text/css" href="/css/style.css?v=0.0.0"><link rel="stylesheet" type="text/css" href="//lib.baomitu.com/normalize/8.0.1/normalize.min.css"><link rel="stylesheet" type="text/css" href="//lib.baomitu.com/pure/1.0.0/pure-min.css"><link rel="stylesheet" type="text/css" href="//lib.baomitu.com/pure/1.0.0/grids-responsive-min.css"><link rel="stylesheet" href="//lib.baomitu.com/font-awesome/4.7.0/css/font-awesome.min.css"><script type="text/javascript" src="//lib.baomitu.com/jquery/3.3.1/jquery.min.js"></script><link rel="icon" mask="" sizes="any" href="/favicon.ico"><link rel="Shortcut Icon" type="image/x-icon" href="/favicon.ico"><link rel="apple-touch-icon" href="/apple-touch-icon.png"><link rel="apple-touch-icon-precomposed" href="/apple-touch-icon.png"><link rel="alternate" type="application/atom+xml" href="/atom.xml"></head><script>(function(d) {
  var config = {
    kitId: 'paj7pia',
    scriptTimeout: 3000,
    async: true
  },
  h=d.documentElement,t=setTimeout(function(){h.className=h.className.replace(/\bwf-loading\b/g,"")+" wf-inactive";},config.scriptTimeout),tk=d.createElement("script"),f=false,s=d.getElementsByTagName("script")[0],a;h.className+=" wf-loading";tk.src='https://use.typekit.net/'+config.kitId+'.js';tk.async=true;tk.onload=tk.onreadystatechange=function(){a=this.readyState;if(f||a&&a!="complete"&&a!="loaded")return;f=true;clearTimeout(t);try{Typekit.load(config)}catch(e){}};s.parentNode.insertBefore(tk,s)
})(document);</script><body><div class="body_container"><div id="header"><div class="site-name"><h1 class="hidden">题红 | 解决 Abode typekit 加载字体过慢</h1><a id="logo" href="/.">懒云休憩室</a><p class="description">醒时诗酒醉时歌，瑶琴不理抛书卧</p></div><div id="nav-menu"><a class="current" href="/."><i class="fa fa-home"> 真的要看吗</i></a><a href="/archives/"><i class="fa fa-archive"> 就是个目录</i></a><a href="/wish/"><i class="fa fa-battery-full"> 摸出许多鱼</i></a><a href="/about/"><i class="fa fa-user"> 猜猜我是谁</i></a><a href="/atom.xml"><i class="fa fa-rss"> RSS</i></a></div></div><div class="pure-g" id="layout"><div class="pure-u-1 pure-u-md-3-4"><div class="content_container"><div class="post"><h1 class="post-title">题红 | 解决 Abode typekit 加载字体过慢</h1><div class="post-meta">Jan 18, 2019<span> | </span><span class="category"><a href="/categories/飞来就我题红/">飞来就我题红</a></span><span class="post-time"><span class="post-meta-item-text"> | </span><span class="post-meta-item-icon"><i class="fa fa-keyboard-o"></i><span class="post-count"> 1k</span><span class="post-meta-item-text"> 字</span></span></span><span class="post-time"> | <span class="post-meta-item-icon"><i class="fa fa-hourglass-half"></i><span class="post-count"> 3</span><span class="post-meta-item-text"> 分钟</span></span></span></div><div class="post-content"><hr>
<p>这个问题其实源自于强迫症…… 在成功换掉了 blog 的字体以后每次打开网页都要加载大概半分多钟，经常一篇文章看都看完了字体还没有加载出来，姗姗来迟的加载好像马后炮，总是让人非常暴躁。<br>人一暴躁就吃不下睡不好，虽然我想减肥但是也得解决它，抄起 Google 百度我就上了。</p>
<p>通过 Google，发现中文字体的加载本身就是一个老大难问题，英文只有 26 个字母，而中文有几千个字，字体文件很大，所以加载会很慢。所以最开始的思路是能不能通过对字库的精简来解决这个加载问题——没打开一篇文章，只加载文章里用到的字。<br>在这里通用的网页解决方法似乎是 <a href="http://font-spider.org/" target="_blank" rel="noopener">字蛛</a>，一个中文字体压缩器，但 CMX 的 lanee 告诉我说字蛛不适合 blog，粗看了一下也确实太麻烦，就放弃了。<br>并且后来发现 Abode Typekit 本身就是动态调用的，所以搞了半天就调用这么几个字也这么慢……</p>
<p>晚上和旋岚在研究这个问题，我觉得他能跟我一起纠结这种纯属强迫症发作的问题真的是人太好了…… 讨论以后明确了字体加载过程是不可避的，那么只能想办法把它变慢（调用 / 下载速度更快），或者想办法绕开这个问题。<br>这时候我找到了两个 blog，共同的特点是不需要经过加载过程，直接显示思源宋体，非常流畅。<br>…… 我十分不乐意，凭什么我做不到嘛！发给旋岚，结果旋岚说这两个 blog 他是需要加载的，我和他唯一的区别是我在电脑上装了思源而他没有，因此这两个 blog 实际上调用的是我的本地字库，不从 Abode Typekit 调用，那当然没有加载过程啦。</p>
<p>那么解决方案就变成了：</p>
<ol>
<li>如果电脑上有思源宋体，那么调用本地字体</li>
<li>如果电脑上没有，从 Abode Typekit 调用加载</li>
</ol>
<p>之前 shioko 给过我一个类似的解决方案，但是她说这个方案会更慢，我研究了一下，果不其然，成功报错。（事实上我搞代码这种东西不报错才不正常……）<br>两个人又吭哧吭哧研究了半天，旋岚突然截个图跟我说，你看你这个字体文件的名字显示的不是 <code>source-han-serif-sc, serif</code> 而是 <code>思源宋体 CN Medium</code><br>我福至心灵一拍大腿，去重写了 family-font<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">font-family: &quot; 思源宋体 CN&quot;, &quot;source-han-serif-sc&quot;, serif,&quot;PingFangSC-Regular&quot;, Helvetica, &quot;Helvetica Neue&quot;, &quot;Segoe UI&quot;, &quot;Hiragino Sans GB&quot;, &quot;Source Han Sans CN&quot;, &quot;Microsoft YaHei&quot;, &quot;STHeiti&quot;, &quot;WenQuanYi Micro Hei&quot;, sans-serif !important;</span><br></pre></td></tr></table></figure></p>
<p>hexo s -debug，成功了！</p>
<hr>
<h3><span id="最后的解决方案">最后的解决方案</span></h3><p>在 Style.css 文件的 pure-g，body，.post-title 下面的 family-font 行的最前面分别加上 <code>&quot;思源宋体 CN&quot;, serif,</code>，当你电脑里有思源宋体的时候，就会直接调用你的本地字体</p>
<p>至于没有的人从 Abode Typekit 加载慢怎么办…… 反正客观事实是字体文件每个 10M，这种老大难问题就交给比较会玩的人来研究吧，我先自己爽了再说（……</p>
<h3><span id="以及另一个小优化">以及另一个小优化</span></h3><p>放弃使用 <code>&lt;!--more--&gt;</code> 而使用在 <code>front-matter</code> 中添加 <code>description:</code> 的方式来显示文章首页的摘要，这样做的优势是点进正文以后不会再显示缩略部分和一个奇丑无比的分割线上文字，那个位置真的很多次让我想要打人。<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">title: 题红 | 解决 Abode typekit 加载字体过慢 </span><br><span class="line">categories:</span><br><span class="line">- 飞来就我题红 </span><br><span class="line">description:</span><br><span class="line">- 其实是一个妥协方案，但是毕竟我拯救不了世界 </span><br></pre></td></tr></table></figure></p>
<p>之前疯狂报错的原因：<code>front-matter</code> 最下面那道分割线真的不能删<em>(:з」∠)</em></p>
</div><div class="tags"></div><div class="post-nav"><a class="pre" href="/2019/01/19/2019-1-19字体加载缓慢破案！/">题红 | 字体加载缓慢破案！</a><a class="next" href="/2019/01/16/2019-1-16修改字体/">题红 | 修改 Maupassant 主题字体为思源宋体</a></div></div></div></div><div class="pure-u-1 pure-u-md-1-4"><div id="sidebar"><div class="widget"><form class="search-form" action="//www.google.com/search" method="get" accept-charset="utf-8" target="_blank"><input type="text" name="q" maxlength="20" placeholder="Search"><input type="hidden" name="sitesearch" value="https://kashuukiyoko.github.io"></form></div><div class="widget"><div class="widget-title"><i class="fa fa-folder-o"> 分类</i></div><ul class="category-list"><li class="category-list-item"><a class="category-list-link" href="/categories/分与读书灯/">分与读书灯</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/放翁又看一年春/">放翁又看一年春</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/醒时节披衣坐/">醒时节披衣坐</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/飞来就我题红/">飞来就我题红</a></li></ul></div><div class="widget"><div class="widget-title"><i class="fa fa-external-link"> 友情链接</i></div><ul></ul><a href="https://miyehn.me/blog/" title="槽" target="_blank">槽</a><ul></ul><a href="http://z.arlmy.me/" title="素生" target="_blank">素生</a><ul></ul><a href="https://xuanlan9870.github.io/" title="烁光荒野" target="_blank">烁光荒野</a><ul></ul><a href="https://co5.me/" title="†少女癌†" target="_blank">†少女癌†</a><ul></ul><a href="https://binghuohunhewu.com/" title="冰火混合物" target="_blank">冰火混合物</a></div></div></div><div class="pure-u-1 pure-u-md-3-4"><div id="footer">Copyright © 2019 <a href="/." rel="nofollow">懒云休憩室.</a> Powered by<a rel="nofollow" target="_blank" href="https://hexo.io"> Hexo.</a><a rel="nofollow" target="_blank" href="https://github.com/tufu9441/maupassant-hexo"> Theme</a> by<a rel="nofollow" target="_blank" href="https://github.com/pagecho"> Cho.</a></div></div></div><a class="show" id="rocket" href="#top"></a><script type="text/javascript" src="/js/totop.js?v=0.0.0" async></script><script type="text/javascript" src="//lib.baomitu.com/fancybox/3.5.2/jquery.fancybox.min.js" async></script><script type="text/javascript" src="/js/fancybox.js?v=0.0.0" async></script><link rel="stylesheet" type="text/css" href="//lib.baomitu.com/fancybox/3.5.2/jquery.fancybox.min.css"><script type="text/javascript" src="/js/codeblock-resizer.js?v=0.0.0"></script><script type="text/javascript" src="/js/smartresize.js?v=0.0.0"></script></div></body></html>